一、系统设计

本系统划分为五个功能模块，分别是读者信息管理模
块、分类目录管理模块、编目管理模块、图书流通管理模块
和账户管理模块.。本文对其中的核心模块即图书流通管理
模块的实现进行描述，以期初步了解c语言在工程实践中的
应用。

图书流通模块主要包括图书检索、图书借阅、图书归
还、续借和查询借阅记录等子模块，因此这里需要建立一个
图书借阅信息类型，用来保存所有读者的借阅信息。定义借
阅信息结构体类型LendInfo如下：
typedef struct{ 

	char Code[20]；／／读者证件号.. 

	char ISBN[50]；／／图书ISBN 

	char LenDate[20]；／／借书日期.. 

	char LastDate[20];  ／／应还日期
	char ReturnDate[20]；／／归还日期.. 

	floatFine；／／罚款 
	intTag；／／图书状态，0：借出，1：已还.. 
}Lendlnfo; 


二、知识储备

根据以上所确定的图书流通模块的主要功能项，本模块的实现涉及的知识点有：顺序表的操作、字符串操作、排序
操作和查找操作等。
①将一维数组和数组长度封装在一个结构体中l2]。 
#define MAXLEN 10
typedef struct{ 
	ElemType elem[MAXLEN]; ／／ElemType是元素类型视具体情况而定.. 
	int length； //表的实际长度
}Linqlist;
②时间处理函数。<time.h>提供的函数可以确定日期和时间，还可以在时间值上进行算术运算、格式化显示等操
作。在此首先明确一下时间的存储。日历时间是通过time_t数据类型来表示的，用这种类型表示的时间是从一个时间点到此时的秒数。在time.h中time_t是一个long int。在本系统应用中，time．h中提供的库函数，如获取系统时间的time()函数、转换时问结构的localtime0函函数、格式化日期时间的strftimeO函数、计算时间差的diffftimeO函数等都会有应用。

三、子模块设计

图书流通模块包含了图书管理的最主要功能，主要包括图书分类浏览、图书检索、借阅图书、查询借阅记录等子模
块，根据各模块的功能设计相关的函数如下列所示：
① 图书分类浏览：
	BroweBookCatalog() 按照图书分类
	CatalogNum浏览图书
	CreatBookList() 建立图书顺序表
② 图书检索： FindISBN() 按ISBN检索图书
	FindTitle0 按书名检索图书
	FineAuthor()按作者检索图书
	FinePublisher()按出版社检索图书
③ 图书借阅： LendBook() 借书
FindReader() 查询读者信息
LendBookNum() 计算读者已借图书数目
SaveLendlnfo() 保存借阅信息到文件lend．txt
Overdue() 查询是否有逾期图书
④ 还书： ReturnBook() 还书
CreateLendLink0从lend．txt读取记录建借阅记录单链表
SaveLendlnfoW()保存链表信息到1end.txt，重写借阅记录
⑤ 续借： RenewBook() 续借图书
⑥ 罚款： Fine() 计算罚款
⑦ 查询借阅记录：FindLendlnfo() 查找lend．txt输出该读者的借阅记录

四、子模块实现
① 图书分类浏览子模块这个子模块的功能是通过输入图书类型分类编号CatalogNum(其中的图书分类是按照文献所属的科学体系，按文献分类法组织而成)，查询输出同一类型的所有图书信息。为了便于排序和查找操作，图书信息在内存中以顺序表的形式存储。其中的BroweBookCatalog0 数，重点部分是字符串比较，分类编码只要前面几个字符符合待查字符串便是属于该
类型的图书，因此使用merncmp0函数。例如，输入TP，是自动化技术、计算机技术类型，凡是编号以TP开头的图书都属于这一类型，查询到这一类型的图书都需要输出其详细信息。同时，设置查询标志flag，初始化为0，如果找到，将其值置为1，查询最后判断如果flag值为0，则表示没有该类型的图书。
而CreatBookList()函数的功能是将文件中的图书信息读人内存，并以顺序表的形式加以存放。采用顺序表的目的是
为了便于各种排序和查找算法的实现。

② 图书检索子模块。在图书检索子模块中，总共采用四种检索方法，分别是ISBN、书名作者和出版社。由于ISBN查询结果唯一，因此，可先将记录按照关键字排序之后再进行折半查找操作，而书名、作者、出版社查询结果可能不是唯一的，故采用顺序查找，支持部分关键字查询和模糊查询。

③ 借阅图书子模块。LendBook0函数实现借书功能。系统设置每位读者最多借阅6本图书，最长借阅期为6O天。借阅记录包含：读者证件号、图书ISBN、借书日期、应还日期、归还日期、借阅状态(0：借出，1：归还)等信息，保存在lend．txt文件中。借书流程如下描述：首先检查读者证件是否挂失(tag==1)，其次检查该读者是否已经借满6本，REGIONINFO数字地方本，上述两个条件同时满足方可进行图书借阅。借书日期通
me'rme

过tiOiN数获取当前系统时间，再用stfti0函数转换为所
需的时间格式，应还日期为60天后的日期，通过时间函数计
算可得，归还日期设置为NULL，最后将借阅记录保存于文

件。

④还书子模块。createLendLink()函数读取lend．txt文件
记录，建立借阅记录单链表，通过证件号和ISBN查询借阅记
录，修改归还日期和借阅状态，最后将单链表重新写回文件
以更新记录。
⑤续借子模块。图书续借的前提是还没有超出应还Et
期，根据证件号和ISBN查询借阅记录，找到后修改当前的系
统时间为借书日期，计算60天后的日期为应还日期，同时还
可以增加新字段记录借阅次数，比如最多续借3次。在本模
块的实现中，可以调用craeedn(、LnBo0等函数
etLnLik)edok
来完成部分操作。

⑥罚款子模块。在借书前还可增加是否有逾期图书未
还的检查，如有，则需要缴纳规定的罚款才能继续借书。
在还书前需检查当前系统时间是否已经超过应还.. Et期，如超
过，则计算罚款数目。
⑦查询借阅记录模块。打开lend．txt文件，以读者证件
号为依据，查询输出相应结果即可。

参考文献.. 

[1J顾俐图书馆图书管理系统的设计U】．中国科技信．g2007年第11
期：175～177．.. 
[2】谭浩强.. c语言程序设计(第三版)【M】．北京：清华大学出版
社，2005